{"version":3,"file":"_PaneItem-e9d8c4da.cjs","sources":["../src/desk/components/MissingSchemaType.tsx","../src/desk/components/paneItem/PaneItem.tsx"],"sourcesContent":["import {WarningOutlineIcon} from '@sanity/icons'\nimport {PreviewValue, SanityDocument} from '@sanity/types'\nimport React from 'react'\nimport {GeneralPreviewLayoutKey} from '../../components/previews'\nimport {SanityDefaultPreview} from '../../preview'\n\nexport interface MissingSchemaTypeProps {\n  layout?: GeneralPreviewLayoutKey\n  value: SanityDocument\n}\n\nconst getUnknownTypeFallback = (id: string, typeName: string): PreviewValue => ({\n  title: (\n    <em>\n      No schema found for type <code>{typeName}</code>\n    </em>\n  ),\n  subtitle: (\n    <em>\n      Document: <code>{id}</code>\n    </em>\n  ),\n  media: WarningOutlineIcon,\n})\n\nexport function MissingSchemaType(props: MissingSchemaTypeProps) {\n  const {layout, value} = props\n\n  return (\n    <SanityDefaultPreview {...getUnknownTypeFallback(value._id, value._type)} layout={layout} />\n  )\n}\n","import {FolderIcon, ChevronRightIcon, DocumentIcon} from '@sanity/icons'\nimport {isSanityDocument, PreviewValue, SanityDocument, SchemaType} from '@sanity/types'\nimport {Text} from '@sanity/ui'\nimport React, {forwardRef, useCallback, useEffect, useMemo, useState} from 'react'\nimport {PreviewCard} from '../../../components/PreviewCard'\nimport {useDocumentPresence, useDocumentPreviewStore} from '../../../datastores'\nimport {useSchema} from '../../../hooks'\nimport {SanityDefaultPreview} from '../../../preview'\nimport {GeneralPreviewLayoutKey} from '../../../components/previews'\nimport {MissingSchemaType} from '../MissingSchemaType'\nimport {usePaneRouter} from '../paneRouter'\nimport {PaneItemPreview} from './PaneItemPreview'\n\ninterface PaneItemProps {\n  id: string\n  layout?: GeneralPreviewLayoutKey\n  icon?: React.ComponentType<any> | false\n  pressed?: boolean\n  selected?: boolean\n  title?: string\n  value?: PreviewValue | SanityDocument\n  schemaType?: SchemaType\n}\n\n/**\n * Return `false` if we explicitly disable the icon.\n * Otherwise return the passed icon or the schema type icon as a backup.\n */\nexport function getIconWithFallback(\n  icon: React.ComponentType<any> | false | undefined,\n  schemaType: SchemaType | undefined,\n  defaultIcon: React.ComponentType<any>\n): React.ComponentType<any> | false {\n  if (icon === false) {\n    return false\n  }\n\n  return icon || (schemaType && schemaType.icon) || defaultIcon || false\n}\n\nexport function PaneItem(props: PaneItemProps) {\n  const {icon, id, layout = 'default', pressed, schemaType, selected, title, value} = props\n  const schema = useSchema()\n  const documentPreviewStore = useDocumentPreviewStore()\n  const {ChildLink} = usePaneRouter()\n  const documentPresence = useDocumentPresence(id)\n  const hasSchemaType = Boolean(schemaType && schemaType.name && schema.get(schemaType.name))\n  const [clicked, setClicked] = useState<boolean>(false)\n\n  const preview = useMemo(() => {\n    if (value && isSanityDocument(value)) {\n      if (!schemaType || !hasSchemaType) {\n        return <MissingSchemaType value={value} />\n      }\n\n      return (\n        <PaneItemPreview\n          documentPreviewStore={documentPreviewStore}\n          icon={getIconWithFallback(icon, schemaType, DocumentIcon)}\n          layout={layout}\n          schemaType={schemaType}\n          value={value}\n          presence={documentPresence}\n        />\n      )\n    }\n\n    return (\n      <SanityDefaultPreview\n        status={\n          <Text muted>\n            <ChevronRightIcon />\n          </Text>\n        }\n        icon={getIconWithFallback(icon, schemaType, FolderIcon)}\n        layout={layout}\n        title={title}\n      />\n    )\n  }, [\n    documentPreviewStore,\n    hasSchemaType,\n    icon,\n    layout,\n    schemaType,\n    title,\n    value,\n    documentPresence,\n  ])\n\n  const LinkComponent = useMemo(\n    () =>\n      // eslint-disable-next-line @typescript-eslint/no-shadow\n      forwardRef(function LinkComponent(linkProps: any, ref: any) {\n        return <ChildLink {...linkProps} childId={id} ref={ref} />\n      }),\n    [ChildLink, id]\n  )\n\n  const handleClick = useCallback(() => setClicked(true), [])\n\n  // Reset `clicked` state when `selected` prop changes\n  useEffect(() => setClicked(false), [selected])\n\n  return useMemo(\n    () => (\n      <PreviewCard\n        __unstable_focusRing\n        as={LinkComponent}\n        data-as=\"a\"\n        data-ui=\"PaneItem\"\n        padding={2}\n        radius={2}\n        onClick={handleClick}\n        pressed={pressed}\n        selected={selected || clicked}\n        tone=\"inherit\"\n      >\n        {preview}\n      </PreviewCard>\n    ),\n    [clicked, handleClick, LinkComponent, pressed, preview, selected]\n  )\n}\n"],"names":["getUnknownTypeFallback","id","typeName","title","jsxs","children","jsx","subtitle","media","WarningOutlineIcon","MissingSchemaType","props","layout","value","SanityDefaultPreview","_id","_type","getIconWithFallback","icon","schemaType","defaultIcon","PaneItem","pressed","selected","schema","useSchema","documentPreviewStore","useDocumentPreviewStore","ChildLink","usePaneRouter","documentPresence","useDocumentPresence","hasSchemaType","Boolean","name","get","clicked","setClicked","useState","preview","useMemo","isSanityDocument","PaneItemPreview","DocumentIcon","presence","status","Text","muted","ChevronRightIcon","FolderIcon","LinkComponent","forwardRef","linkProps","ref","childId","handleClick","useCallback","useEffect","PreviewCard","__unstable_focusRing","as","padding","radius","onClick","tone"],"mappings":"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"}