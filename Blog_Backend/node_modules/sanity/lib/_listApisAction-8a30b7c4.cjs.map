{"version":3,"file":"_listApisAction-8a30b7c4.cjs","sources":["../src/cli/actions/graphql/listApisAction.ts"],"sourcesContent":["import type {CliCommandArguments, CliCommandContext} from '@sanity/cli'\n\ntype ListApisResponse = {\n  projectId: string\n  dataset: string\n  tag: string\n  playgroundEnabled: boolean\n  generation: string\n}[]\n\nexport default async function listGraphQLApis(\n  args: CliCommandArguments<Record<string, unknown>>,\n  context: CliCommandContext\n): Promise<void> {\n  const {apiClient, output, chalk} = context\n\n  const client = apiClient({\n    requireUser: true,\n    requireProject: true,\n  }).config({apiVersion: '1'})\n\n  let endpoints: ListApisResponse | undefined\n  try {\n    endpoints = await client.request<ListApisResponse>({\n      url: '/apis/graphql',\n      method: 'GET',\n    })\n  } catch (err) {\n    throw err\n  }\n\n  if (!endpoints || endpoints.length === 0) {\n    output.print(\"This project doesn't have any GraphQL endpoints deployed.\")\n    return\n  }\n\n  output.print('Here are the GraphQL endpoints deployed for this project:')\n  endpoints.forEach((endpoint, index) => {\n    const {dataset, tag} = endpoint\n    const url = client.getUrl(`graphql/${dataset}/${tag}`)\n\n    output.print(`${index + 1}.  ${chalk.bold('Dataset:')}     ${dataset}`)\n    output.print(`    ${chalk.bold('Tag:')}         ${tag}`)\n    output.print(`    ${chalk.bold('Generation:')}  ${endpoint.generation}`)\n    output.print(`    ${chalk.bold('Playground:')}  ${endpoint.playgroundEnabled}`)\n    output.print(`    ${chalk.bold('URL:')}  ${url}\\n`)\n  })\n}\n"],"names":["listGraphQLApis","args","context","apiClient","output","chalk","client","requireUser","requireProject","config","apiVersion","endpoints","request","url","method","err","length","print","forEach","endpoint","index","dataset","tag","getUrl","bold","generation","playgroundEnabled"],"mappings":";;AAU8B,eAAAA,eAAA,CAC5BC,IAD4B,EAE5BC,OAF4B,EAGb;EACf,MAAM;IAACC,SAAD;IAAYC,MAAZ;IAAoBC;EAApB,IAA6BH,OAAnC;EAEA,MAAMI,SAASH,SAAU,CAAA;IACvBI,WAAa,EAAA,IADU;IAEvBC,cAAgB,EAAA;EAFO,CAAA,CAAV,CAGZC,MAHY,CAGL;IAACC,UAAA,EAAY;EAAb,CAHK,CAAf;EAKI,IAAAC,SAAA;;EACA,IAAA;IACUA,SAAA,GAAA,MAAML,OAAOM,OAAP,CAAiC;MACjDC,GAAK,EAAA,eAD4C;MAEjDC,MAAQ,EAAA;IAFyC,CAAjC,CAAN;GADV,QAKKC,KAAP;IACM,MAAAA,GAAA;EACR;;EAEA,IAAI,CAACJ,SAAD,IAAcA,SAAU,CAAAK,MAAV,KAAqB,CAAvC,EAA0C;IACxCZ,MAAA,CAAOa,KAAP,CAAa,2DAAb;IACA;EACF;;EAEAb,MAAA,CAAOa,KAAP,CAAa,2DAAb;EACUN,SAAA,CAAAO,OAAA,CAAQ,CAACC,QAAD,EAAWC,KAAX,KAAqB;IAC/B,MAAA;MAACC,OAAD;MAAUC;IAAV,IAAiBH,QAAjB;IACN,MAAMN,GAAM,GAAAP,MAAA,CAAOiB,MAAP,mBAAyBF,OAAzB,cAAoCC,GAApC,EAAZ;IAEOlB,MAAA,CAAAa,KAAA,WAASG,KAAQ,GAAA,CAAjB,gBAAwBf,MAAMmB,IAAN,CAAW,UAAX,CAAxB,kBAAsDH,OAAtD;IACPjB,MAAA,CAAOa,KAAP,eAAoBZ,KAAA,CAAMmB,IAAN,CAAW,MAAX,CAApB,sBAAkDF,GAAlD;IACAlB,MAAA,CAAOa,KAAP,eAAoBZ,KAAA,CAAMmB,IAAN,CAAW,aAAX,CAApB,eAAkDL,SAASM,UAA3D;IACArB,MAAA,CAAOa,KAAP,eAAoBZ,KAAA,CAAMmB,IAAN,CAAW,aAAX,CAApB,eAAkDL,SAASO,iBAA3D;IACAtB,MAAA,CAAOa,KAAP,eAAoBZ,KAAM,CAAAmB,IAAN,CAAW,MAAX,CAApB,eAA2CX,GAA3C;EACD,CATS;AAUZ;;"}