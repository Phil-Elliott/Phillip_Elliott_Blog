{"version":3,"file":"_PaneItem-8a2965a6.js","sources":["../src/desk/components/MissingSchemaType.tsx","../src/desk/components/paneItem/PaneItem.tsx"],"sourcesContent":["import {WarningOutlineIcon} from '@sanity/icons'\nimport {PreviewValue, SanityDocument} from '@sanity/types'\nimport React from 'react'\nimport {GeneralPreviewLayoutKey} from '../../components/previews'\nimport {SanityDefaultPreview} from '../../preview'\n\nexport interface MissingSchemaTypeProps {\n  layout?: GeneralPreviewLayoutKey\n  value: SanityDocument\n}\n\nconst getUnknownTypeFallback = (id: string, typeName: string): PreviewValue => ({\n  title: (\n    <em>\n      No schema found for type <code>{typeName}</code>\n    </em>\n  ),\n  subtitle: (\n    <em>\n      Document: <code>{id}</code>\n    </em>\n  ),\n  media: WarningOutlineIcon,\n})\n\nexport function MissingSchemaType(props: MissingSchemaTypeProps) {\n  const {layout, value} = props\n\n  return (\n    <SanityDefaultPreview {...getUnknownTypeFallback(value._id, value._type)} layout={layout} />\n  )\n}\n","import {FolderIcon, ChevronRightIcon, DocumentIcon} from '@sanity/icons'\nimport {isSanityDocument, PreviewValue, SanityDocument, SchemaType} from '@sanity/types'\nimport {Text} from '@sanity/ui'\nimport React, {forwardRef, useCallback, useEffect, useMemo, useState} from 'react'\nimport {PreviewCard} from '../../../components/PreviewCard'\nimport {useDocumentPresence, useDocumentPreviewStore} from '../../../datastores'\nimport {useSchema} from '../../../hooks'\nimport {SanityDefaultPreview} from '../../../preview'\nimport {GeneralPreviewLayoutKey} from '../../../components/previews'\nimport {MissingSchemaType} from '../MissingSchemaType'\nimport {usePaneRouter} from '../paneRouter'\nimport {PaneItemPreview} from './PaneItemPreview'\n\ninterface PaneItemProps {\n  id: string\n  layout?: GeneralPreviewLayoutKey\n  icon?: React.ComponentType<any> | false\n  pressed?: boolean\n  selected?: boolean\n  title?: string\n  value?: PreviewValue | SanityDocument\n  schemaType?: SchemaType\n}\n\n/**\n * Return `false` if we explicitly disable the icon.\n * Otherwise return the passed icon or the schema type icon as a backup.\n */\nexport function getIconWithFallback(\n  icon: React.ComponentType<any> | false | undefined,\n  schemaType: SchemaType | undefined,\n  defaultIcon: React.ComponentType<any>\n): React.ComponentType<any> | false {\n  if (icon === false) {\n    return false\n  }\n\n  return icon || (schemaType && schemaType.icon) || defaultIcon || false\n}\n\nexport function PaneItem(props: PaneItemProps) {\n  const {icon, id, layout = 'default', pressed, schemaType, selected, title, value} = props\n  const schema = useSchema()\n  const documentPreviewStore = useDocumentPreviewStore()\n  const {ChildLink} = usePaneRouter()\n  const documentPresence = useDocumentPresence(id)\n  const hasSchemaType = Boolean(schemaType && schemaType.name && schema.get(schemaType.name))\n  const [clicked, setClicked] = useState<boolean>(false)\n\n  const preview = useMemo(() => {\n    if (value && isSanityDocument(value)) {\n      if (!schemaType || !hasSchemaType) {\n        return <MissingSchemaType value={value} />\n      }\n\n      return (\n        <PaneItemPreview\n          documentPreviewStore={documentPreviewStore}\n          icon={getIconWithFallback(icon, schemaType, DocumentIcon)}\n          layout={layout}\n          schemaType={schemaType}\n          value={value}\n          presence={documentPresence}\n        />\n      )\n    }\n\n    return (\n      <SanityDefaultPreview\n        status={\n          <Text muted>\n            <ChevronRightIcon />\n          </Text>\n        }\n        icon={getIconWithFallback(icon, schemaType, FolderIcon)}\n        layout={layout}\n        title={title}\n      />\n    )\n  }, [\n    documentPreviewStore,\n    hasSchemaType,\n    icon,\n    layout,\n    schemaType,\n    title,\n    value,\n    documentPresence,\n  ])\n\n  const LinkComponent = useMemo(\n    () =>\n      // eslint-disable-next-line @typescript-eslint/no-shadow\n      forwardRef(function LinkComponent(linkProps: any, ref: any) {\n        return <ChildLink {...linkProps} childId={id} ref={ref} />\n      }),\n    [ChildLink, id]\n  )\n\n  const handleClick = useCallback(() => setClicked(true), [])\n\n  // Reset `clicked` state when `selected` prop changes\n  useEffect(() => setClicked(false), [selected])\n\n  return useMemo(\n    () => (\n      <PreviewCard\n        __unstable_focusRing\n        as={LinkComponent}\n        data-as=\"a\"\n        data-ui=\"PaneItem\"\n        padding={2}\n        radius={2}\n        onClick={handleClick}\n        pressed={pressed}\n        selected={selected || clicked}\n        tone=\"inherit\"\n      >\n        {preview}\n      </PreviewCard>\n    ),\n    [clicked, handleClick, LinkComponent, pressed, preview, selected]\n  )\n}\n"],"names":["getUnknownTypeFallback","id","typeName","title","jsxs","children","jsx","subtitle","media","WarningOutlineIcon","MissingSchemaType","props","layout","value","SanityDefaultPreview","_id","_type","getIconWithFallback","icon","schemaType","defaultIcon","PaneItem","pressed","selected","schema","useSchema","documentPreviewStore","useDocumentPreviewStore","ChildLink","usePaneRouter","documentPresence","useDocumentPresence","hasSchemaType","Boolean","name","get","clicked","setClicked","useState","preview","useMemo","isSanityDocument","PaneItemPreview","DocumentIcon","presence","status","Text","muted","ChevronRightIcon","FolderIcon","LinkComponent","forwardRef","linkProps","ref","childId","handleClick","useCallback","useEffect","PreviewCard","__unstable_focusRing","as","padding","radius","onClick","tone"],"mappings":"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"}