{"mappings":"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","sources":["src/index.ts","src/components/UnsplashAssetSource.tsx","src/components/Photo.tsx","src/components/Photo.styled.tsx","src/datastores/unsplash.ts","src/components/UnsplashAssetSource.styled.tsx","src/components/Icon.tsx"],"sourcesContent":["import Unsplash from './components/UnsplashAssetSource'\nimport Icon from './components/Icon'\nimport { createPlugin, AssetSource } from 'sanity'\n\nexport const unsplashAssetSource: AssetSource = {\n  name: 'unsplash',\n  title: 'Unsplash',\n  component: Unsplash,\n  icon: Icon,\n}\n\nexport const unsplashImageAsset = createPlugin({\n  name: 'asset-source-unsplash-plugin',\n\n  form: {\n    image: {\n      assetSources: (prev) => {\n        return [...prev, unsplashAssetSource]\n      },\n    },\n  },\n})\n","import React from 'react'\nimport PhotoAlbum from 'react-photo-album'\nimport flatten from 'lodash/flatten'\nimport { BehaviorSubject, Subscription } from 'rxjs'\nimport { UnsplashPhoto } from '../types'\nimport Photo from './Photo'\nimport { fetchDownloadUrl, search } from '../datastores/unsplash'\nimport { Card, Dialog, Flex, Spinner, Stack, Text, TextInput } from '@sanity/ui'\nimport { Search } from './UnsplashAssetSource.styled'\nimport InfiniteScroll from 'react-infinite-scroll-component'\nimport { useClient, AssetSourceComponentProps, AssetFromSource } from 'sanity'\nimport { SanityClient } from '@sanity/client'\n\ntype State = {\n  query: string\n  searchResults: UnsplashPhoto[][]\n  page: number\n  isLoading: boolean\n  cursor: number\n}\n\nconst RESULTS_PER_PAGE = 42\nconst PHOTO_SPACING = 2\nconst PHOTO_PADDING = 1 // offset the 1px border width\n\nexport default function UnsplashAssetSource(props: AssetSourceComponentProps) {\n  const client = useClient({ apiVersion: '2022-09-01' })\n  return <UnsplashAssetSourceInternal {...props} client={client} />\n}\n\nclass UnsplashAssetSourceInternal extends React.Component<\n  AssetSourceComponentProps & { client: SanityClient },\n  State\n> {\n  static defaultProps = {\n    selectedAssets: undefined,\n  }\n\n  state = {\n    cursor: 0,\n    query: '',\n    page: 1,\n    searchResults: [[]],\n    isLoading: true,\n  }\n\n  searchSubscription: Subscription | null = null\n\n  searchSubject$ = new BehaviorSubject('')\n  pageSubject$ = new BehaviorSubject(1)\n\n  componentDidMount() {\n    this.searchSubscription = search(\n      this.props.client,\n      this.searchSubject$,\n      this.pageSubject$,\n      RESULTS_PER_PAGE\n    ).subscribe({\n      next: (results: UnsplashPhoto[]) => {\n        this.setState((prev) => ({\n          searchResults: [...prev.searchResults, results],\n          isLoading: false,\n        }))\n      },\n    })\n  }\n\n  componentWillUnmount() {\n    if (this.searchSubscription) {\n      this.searchSubscription.unsubscribe()\n    }\n  }\n\n  handleSelect = (photo: UnsplashPhoto) => {\n    this.setState({ isLoading: true })\n    return fetchDownloadUrl(this.props.client, photo).then((downloadUrl) => {\n      const description = photo.description || undefined\n      const asset: AssetFromSource = {\n        kind: 'url',\n        value: downloadUrl,\n        assetDocumentProps: {\n          _type: 'sanity.imageAsset',\n          source: {\n            name: 'unsplash',\n            id: photo.id,\n            url: photo.links.html,\n          },\n          description,\n          creditLine: `${photo.user.name} by Unsplash`,\n        } as any,\n      }\n      this.props.onSelect([asset])\n    })\n  }\n\n  handleClose = () => {\n    this.props.onClose()\n  }\n\n  handleSearchTermChanged = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const query = event.currentTarget.value\n    this.setState({ query, page: 1, searchResults: [[]], isLoading: true, cursor: 0 })\n    this.pageSubject$.next(1)\n    this.searchSubject$.next(query)\n  }\n\n  handleScollerLoadMore = () => {\n    // eslint-disable-next-line react/no-access-state-in-setstate\n    const nextPage = this.state.page + 1\n    this.setState({ page: nextPage, isLoading: true })\n    this.pageSubject$.next(nextPage)\n    this.searchSubject$.next(this.state.query)\n  }\n\n  handleKeyDown = (event: any) => {\n    const { cursor } = this.state\n    if ((event.keyCode === 38 || event.keyCode === 37) && cursor > 0) {\n      this.setState((prevState) => ({\n        cursor: prevState.cursor - 1,\n      }))\n    } else if (\n      (event.keyCode === 40 || event.keyCode === 39) &&\n      cursor < this.getPhotos().length - 1\n    ) {\n      this.setState((prevState) => ({\n        cursor: prevState.cursor + 1,\n      }))\n    }\n  }\n\n  getPhotos() {\n    return flatten(this.state.searchResults)\n  }\n\n  updateCursor = (photo: UnsplashPhoto) => {\n    const index = this.getPhotos().findIndex((result: UnsplashPhoto) => result.id === photo.id)\n    this.setState({ cursor: index })\n  }\n\n  renderImage = (props: any) => {\n    const { photo, layout } = props\n    const active =\n      this.getPhotos().findIndex((result: UnsplashPhoto) => result.id === photo.data.id) ===\n        this.state.cursor || false\n    return (\n      <Photo\n        onClick={this.handleSelect.bind(photo.data)}\n        onKeyDown={this.handleKeyDown}\n        data={photo.data}\n        width={layout.width}\n        height={layout.height}\n        active={active}\n        onFocus={this.updateCursor}\n      />\n    )\n  }\n\n  render() {\n    const { query, searchResults, isLoading } = this.state\n\n    return (\n      <Dialog\n        id=\"unsplash-asset-source\"\n        header=\"Select image from Unsplash\"\n        onClose={this.handleClose}\n        open\n        width={4}\n      >\n        <Stack space={3} padding={4}>\n          <Card>\n            <Search space={3}>\n              <Text size={1} weight=\"semibold\">\n                Search Unsplash\n              </Text>\n              <TextInput\n                label=\"Search Unsplash.com\"\n                placeholder=\"Topics or colors\"\n                value={query}\n                onChange={this.handleSearchTermChanged}\n              />\n            </Search>\n          </Card>\n          {!isLoading && this.getPhotos().length === 0 && (\n            <Text size={1} muted>\n              No results found\n            </Text>\n          )}\n          <InfiniteScroll\n            dataLength={this.getPhotos().length} // This is important field to render the next data\n            next={this.handleScollerLoadMore}\n            // scrollableTarget=\"unsplash-scroller\"\n            hasMore\n            scrollThreshold={0.99}\n            height=\"60vh\"\n            loader={\n              <Flex align=\"center\" justify=\"center\" padding={3}>\n                <Spinner muted />\n              </Flex>\n            }\n            endMessage={\n              <Text size={1} muted>\n                No more results\n              </Text>\n            }\n          >\n            {searchResults\n              .filter((photos) => photos.length > 0)\n              .map((photos: UnsplashPhoto[], index) => (\n                <PhotoAlbum\n                  key={`gallery-${query || 'popular'}-${index}`}\n                  layout=\"rows\"\n                  spacing={PHOTO_SPACING}\n                  padding={PHOTO_PADDING}\n                  targetRowHeight={(width) => {\n                    if (width < 300) return 150\n                    else if (width < 600) return 200\n                    return 300\n                  }}\n                  photos={photos.map((photo: UnsplashPhoto) => ({\n                    src: photo.urls.small,\n                    width: photo.width,\n                    height: photo.height,\n                    key: photo.id,\n                    data: photo,\n                  }))}\n                  renderPhoto={this.renderImage}\n                  componentsProps={{\n                    containerProps: { style: { marginBottom: `${PHOTO_SPACING}px` } },\n                  }}\n                />\n              ))}\n          </InfiniteScroll>\n        </Stack>\n      </Dialog>\n    )\n  }\n}\n","import { Text, useTheme } from '@sanity/ui'\nimport React, { useCallback, useEffect, useRef } from 'react'\nimport { UnsplashPhoto } from 'src/types'\nimport { CreditLine, CreditLineLink, Root } from './Photo.styled'\n\ntype Props = {\n  data: UnsplashPhoto\n  width: number\n  height: number\n  onClick: (photo: UnsplashPhoto) => void\n  onKeyDown: (event: any) => void\n  active: boolean\n  onFocus: (photo: UnsplashPhoto) => void\n}\n\nconst UTM_SOURCE = 'sanity-plugin-asset-source-unsplash'\n\nexport default function Photo(props: Props) {\n  const { onClick, data, onKeyDown, onFocus, active, width, height } = props\n  const rootElm = useRef<HTMLDivElement>(null)\n  const prevActive = useRef<boolean>(false)\n\n  const handleClick = useCallback(() => {\n    onClick(data)\n  }, [onClick, data])\n\n  const handleCreditLineClicked = useCallback(\n    (event: any) => {\n      event.stopPropagation()\n      const url = `${data.links.html}?utm_source=${encodeURIComponent(\n        UTM_SOURCE\n      )}&utm_medium=referral`\n      window.open(url, data.id, 'noreferrer,noopener')\n    },\n    [data]\n  )\n\n  const handleKeyDown = useCallback(\n    (event: any) => {\n      onKeyDown(event)\n      if (event.keyCode === 13) {\n        onClick(data)\n      }\n    },\n    [onKeyDown, data, onClick]\n  )\n\n  const handleMouseDown = useCallback(() => {\n    onFocus(data)\n  }, [onFocus, data])\n\n  useEffect(() => {\n    if (!prevActive.current && active && rootElm.current) {\n      rootElm.current.focus()\n      onFocus(data)\n    }\n    prevActive.current = active\n    // data changing alone should not re-trigger effect\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [active])\n\n  const src = data.urls.small\n  const userName = data.user.name\n\n  const theme = useTheme().sanity\n  return (\n    <Root\n      ref={rootElm}\n      studioTheme={theme}\n      title={`Select image by ${userName} from Unsplash`}\n      tabIndex={0}\n      onKeyDown={handleKeyDown}\n      onMouseDown={handleMouseDown}\n      style={{\n        width: `${width}px`,\n        height: `${height}px`,\n        backgroundImage: `url(\"${src}\")`,\n      }}\n      onClick={handleClick}\n    >\n      <CreditLineLink onClick={handleCreditLineClicked}>\n        <CreditLine padding={2} radius={2} margin={2}>\n          <Text size={1} title={`Open image by ${userName} on Unsplash in new window`}>\n            By @{data.user.username}\n          </Text>\n        </CreditLine>\n      </CreditLineLink>\n    </Root>\n  )\n}\n","import { Card, Theme } from '@sanity/ui'\nimport styled from 'styled-components'\n\ntype SanityTheme = Theme['sanity']\n\ninterface Style {\n  studioTheme: SanityTheme\n}\n\nexport const Root = styled.div`\n  overflow: hidden;\n  background-origin: content-box;\n  background-repeat: no-repeat;\n  background-clip: border-box;\n  background-size: cover;\n  position: relative;\n  outline: none !important;\n  border: ${({ studioTheme }: Style) => `1px solid ${studioTheme.color.card.enabled.border}`};\n  box-sizing: content-box;\n  user-drag: none;\n\n  &:hover {\n    opacity: 0.85;\n  }\n\n  &:focus,\n  &:active {\n    border: 1px solid var(--input-border-color-focus);\n    box-shadow: inset 0 0 0 3px var(--input-border-color-focus);\n  }\n`\n\nexport const CreditLineLink = styled.a`\n  text-decoration: none;\n  cursor: pointer;\n`\n\nexport const CreditLine = styled(Card)`\n  ${({ theme }) => `\n     --creditline-fg: ${theme.sanity.color.card.enabled.fg};\n     --creditline-bg: ${theme.sanity.color.card.enabled.bg};\n   `};\n  user-drag: none;\n  position: absolute;\n  background-color: var(--creditline-bg);\n  bottom: 0;\n\n  [data-ui='Text'] {\n    color: var(--creditline-fg);\n  }\n`\n","import { defer, concat, BehaviorSubject, Observable } from 'rxjs'\nimport { debounceTime, switchMap, map, distinctUntilChanged, withLatestFrom } from 'rxjs/operators'\nimport { UnsplashPhoto } from 'src/types'\nimport { SanityClient } from '@sanity/client'\n\ntype SearchSubject = BehaviorSubject<string>\ntype PageSubject = BehaviorSubject<number>\n\nconst fetchSearch = (\n  client: SanityClient,\n  query: string,\n  page: number,\n  perPage: number\n): Observable<any> =>\n  defer(() =>\n    client.observable.request({\n      url: `/addons/unsplash/search/photos?query=${encodeURIComponent(\n        query\n      )}&page=${page}&per_page=${perPage}`,\n      withCredentials: true,\n      method: 'GET',\n    })\n  )\n\nconst fetchList = (\n  client: SanityClient,\n  type: string,\n  page: number,\n  perPage: number\n): Observable<any> =>\n  defer(() =>\n    client.observable.request({\n      url: `/addons/unsplash/photos?order_by=${type}&page=${page}&per_page=${perPage}`,\n      withCredentials: true,\n      method: 'GET',\n    })\n  )\n\nexport function fetchDownloadUrl(client: SanityClient, photo: UnsplashPhoto): Promise<string> {\n  const downloadUrl = photo.links.download_location.replace(\n    'https://api.unsplash.com',\n    '/addons/unsplash'\n  )\n  return client\n    .request({\n      url: downloadUrl,\n      withCredentials: true,\n      method: 'GET',\n    })\n    .then((result: { url: string }) => {\n      return result.url\n    })\n}\n\nexport const search = (\n  client: SanityClient,\n  query: SearchSubject,\n  page: PageSubject,\n  resultsPerPage: number\n): Observable<any> => {\n  return concat(\n    query.pipe(\n      withLatestFrom(page),\n      debounceTime(500),\n      distinctUntilChanged(),\n      switchMap(([q, p]) => {\n        if (q) {\n          return fetchSearch(client, q, p, resultsPerPage).pipe(\n            distinctUntilChanged(),\n            map((result) => result.results)\n          )\n        }\n        return fetchList(client, 'popular', p, resultsPerPage)\n      })\n    )\n  )\n}\n","import { Stack } from '@sanity/ui'\nimport styled from 'styled-components'\n\nexport const Search = styled(Stack)`\n  position: sticky;\n  top: 0;\n  z-index: 1;\n`\n\nexport const Scroller = styled.div`\n  overflow-y: auto;\n  max-height: 80vh;\n`\n","import React from 'react'\nimport styled from 'styled-components'\n\nconst Svg = styled.svg`\n  transform: scale(0.8);\n`\n\nexport default function UnsplashIcon() {\n  return (\n    <Svg role=\"img\" viewBox=\"0 0 24 24\" width=\"1em\" height=\"1em\" fill=\"currentColor\">\n      <title />\n      <path d=\"M7.5 6.75V0h9v6.75h-9zm9 3.75H24V24H0V10.5h7.5v6.75h9V10.5z\" />\n    </Svg>\n  )\n}\n"],"names":[],"version":3,"file":"index.modern.js.map","sourceRoot":"../"}